# دليل حدود الاستخدام وكودات الخصم

## نظرة عامة

تم تطوير نظام متقدم لإدارة حدود استخدام العروض وكودات الخصم في منصة Happy Perks Hub، يوفر مرونة كاملة للموردين في تحديد كيفية استفادة الموظفين من العروض.

---

## 🎯 حدود الاستخدام (Usage Limits)

### الأنواع المتاحة:

#### 1. **مرة واحدة لكل موظف** (Once Per Employee)

- يمكن للموظف الاستفادة من العرض مرة واحدة فقط
- بعد الاستبدال، يختفي العرض من صفحة العروض للموظف
- ينتقل العرض إلى صفحة "كوبوناتي" للمراجعة
- مناسب ل��عروض المحدودة أو التجريبية

#### 2. **عدد محدود من المرات** (Multiple Uses)

- يحدد المورد عدد مرات الاستفادة لكل موظف (2-10 مرات)
- يظهر العداد للموظف كم مرة متبقية
- بعد انتهاء العدد المحدد، يختفي العرض من صفحة العروض
- مناسب للعروض الشهرية أو الموسمية

#### 3. **غير محدود** (Unlimited)

- يمكن للموظف الاستفادة من العرض عدة مرات
- لا توجد قيود على عدد مرات الاستخدام
- مناسب للعروض الدائمة والخدمات المستمرة

---

## 💳 كودات الخصم للعروض الإلكترونية

### للعروض الإلكترونية، يوجد خيارين:

#### 1. **توليد تلقائي** (Auto Generated)

- يتم إنشاء كود خصم فريد لكل موظف تلقائياً
- يضمن عدم تكرار الاستخدام
- مناسب للتتبع الدقيق والأمان العالي
- نمط الكود: `ABC123DEF456` (فريد لكل موظف)

#### 2. **كود من المورد** (Supplier Provided)

- يقوم المورد بتقديم كود خصم ثابت
- جميع الموظفين يستخدمون نفس الكود
- مناسب للعروض العامة والترويجية
- مثال: `COMPANY20OFF`

---

## 📱 صفحة "كوبوناتي" الجديدة

### الميزات:

#### 🗂️ **تبويبات منظمة:**

- **نشطة**: الكوبونات الصالحة للاستخدام
- **مستخدمة**: الكوبونات التي تم استخدامها
- **منتهية الصلاحية**: الكوبونات المنتهية

#### 🎫 **عرض شامل لكل كوبون:**

- معلومات العرض والمورد
- تاريخ الاستبدال وانتهاء الصلاحية
- كود الخصم للعروض الإلكترونية
- عنوان الفرع للعروض المحلية

#### 🔧 **أدوات مفيدة:**

- عرض البطاقة مع الباركود
- نسخ كود الخصم بنقرة واحدة
- تحميل البطاقة كصورة
- زيارة الموقع الإلكتروني مباشرة

---

## 🛠️ للموردين: إنشاء عرض بحدود الاستخدام

### خطوات إنشاء العرض:

1. **تحديد حدود الاستخدام:**

   - اختر النوع المناسب لعرضك
   - حدد عدد المرات إذا اخترت "عدد محدود"

2. **اختيار طريقة الاستفادة:**

   - **للفرع**: أدخل عنوان الفرع بدقة
   - **للموقع**: أدخل الرابط وحدد نوع كود الخصم

3. **إعدادات كود الخصم (للمواقع الإلكترونية):**
   - **توليد تلقائي**: للأمان والتتبع الدقيق
   - **كود مخصص**: إذا كان لديك كود خاص

### 💡 **نصائح للموردين:**

- استخدم "مرة واحدة" للعروض التجريبية والمحدودة
- استخدم "عدد محدود" للعروض الشهرية (2-3 مرات)
- استخدم "غير محدود" للخدمات الدائمة
- للمواقع الإلكترونية، اختر "توليد تلقائي" لأفضل تتبع

---

## 👥 للموظفين: كيفية الاستفادة

### للعروض الإلكترونية:

1. استبدل العرض من صفحة العروض
2. احصل على كود الخصم الفريد
3. زر الموقع الإلكتروني
4. استخدم الكود عند الدفع
5. راجع الكوبون في صفحة "كوبوناتي"

### لعروض الفرع:

1. استبدل العرض من صفحة العروض
2. احصل على بطاقة الخصم مع الباركود
3. احفظ أو اطبع البطاقة
4. اذهب للفرع واعرض البطاقة مع الهوية
5. راجع الكوبون في صفحة "كوبوناتي"

---

## 🔒 الأمان والتتبع

### حماية من الاستخدام المكرر:

- تتبع دقيق لعدد مرات الاستخدام لكل موظف
- إخفاء العروض المستنفدة من صفحة العروض
- كودات خصم فريدة لكل موظف (في التوليد التلقائي)

### تتبع الاستخدام:

- سجل كامل لجميع عمليات الاستبدال
- إحصائيات دقيقة للموردين
- تقارير مفصلة للإدارة

### منع التلاعب:

- ربط الكوبونات بالموظف والعرض
- تشفير البيانات الحساسة
- تاريخ انتهاء صلاحية واضح

---

## 📊 للإدارة: التقارير والإحصائيات

### بيانات متقدمة:

- معدل استخدام العروض حسب النوع
- إحصائيات الكوبونات المستخدمة/النشطة
- تحليل سلوك الموظفين في الاستفادة
- أداء المور��ين حسب نوع العروض

### مؤشرات الأداء:

- نسبة الاستفادة من العروض محدودة الاستخدام
- معدل تكرار الاستفادة للعروض المتعددة
- نسبة انتهاء الصلاحية قبل الاستخدام

---

## 🚀 الفوائد والمزايا

### للشركة:

- ✅ تحكم دقيق في ميزانية المزايا
- ✅ تحليل أفضل لسلوك الموظفين
- ✅ منع الاستخدام المفرط للعروض
- ✅ إحصائيات شاملة ودقيقة

### للموردين:

- ✅ مرونة كاملة في تحديد شروط العروض
- ✅ حماية من الاستخدام المكرر غير المرغوب
- ✅ تتبع دقيق لفعالية العروض
- ✅ إمكانية تقديم عروض متنوعة

### للموظفين:

- ✅ وضوح في شروط كل عرض
- ✅ عرض منظم لجميع الكوبونات
- ✅ سهولة الوصول للكوبونات المحفوظة
- ✅ معلومات واضحة عن حالة كل كوبون

---

## 🔧 الدعم التقني

### ملفات النظام:

- `src/lib/offerUsageTracker.ts`: محرك تتبع الاستخدام
- `src/pages/employee/MyRedemptions.tsx`: صفحة الكوبونات
- `src/components/RedemptionModal.tsx`: نافذة الاستبدال المحدثة
- `src/pages/supplier/CreateOffer.tsx`: نموذج إنشاء العروض المحدث

### قاعدة البيانات:

- `EmployeeOfferUsage`: تتبع استخدام كل موظف
- `OfferUsageLimit`: تحديد نوع الحد للعرض
- `DiscountCodeType`: نوع كود الخصم للعروض الإلكترونية

---

**تم تطوير هذا النظام بعناية فائقة لضمان تجربة مثالية وأمان عالي وتتبع دقيق لجميع العمليات.**
